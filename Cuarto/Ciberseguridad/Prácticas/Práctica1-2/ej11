#!/usr/bin/env python3
# Requiere: pip install pwntools
from pwn import remote
import binascii

HOST = "ic.catedras.linti.unlp.edu.ar"
PORT = 11015

def main():
    con = remote(HOST, PORT)
    con.recvuntil(b"primer palabra es:\n")
    hint = con.recvline().strip()  
    print(hint)             # e.g. b"peluca"
    cipher_hex = con.recvline().strip().decode()# e.g. "1406..."
    print(cipher_hex)
    cipher = binascii.unhexlify(cipher_hex)

    # deducir clave de 4 bytes usando los primeros 4 bytes de la pista
    hint_bytes = hint[:4]
    key = bytes([cipher[i] ^ hint_bytes[i] for i in range(4)])

    # descifrar todo
    plain = bytes([cipher[i] ^ key[i % 4] for i in range(len(cipher))])

    # enviar texto plano (con newline)
    con.sendline(plain)
    print(con.recvall().decode(errors="ignore"))

if __name__ == "__main__":
    main()
